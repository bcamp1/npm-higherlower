const axios = require('axios');
const cheerio = require('cheerio');

const url = 'https://www.npmjs.com/package/';

const downloads = function(str){
    if (str === undefined || str === ""){
        console.log(`\x1b[31mYou didn't enter a package name.\x1b[0m`);
    }else if(typeof(str) !== "string"){
        console.log(`\x1b[31mThe package name needs to be a string.\x1b[0m`);
    }else{
        axios(url+str).then(response => {
            const html = response.data;
            const $ = cheerio.load(html);
            const downloads = $("._9ba9a726").text();
            console.log(typeof downloads)
            if(downloads === ""){
                console.log(`\x1b[32mThe package \x1b[33m${str}'s\x1b[32m weekly downloads are : \x1b[33m0\x1b[0m`);
            }else{
                console.log(`\x1b[32mThe package \x1b[33m${str}'s\x1b[32m weekly downloads are : \x1b[33m${downloads}\x1b[0m`);
            }
        }).catch(()=>{
            console.log(`\x1b[31mThe package you searched for doesn't exist on npm.\x1b[0m`);
        });
    }
}
module.exports = downloads;